# æœŸè´§å›æµ‹ç³»ç»ŸåŸºç¡€æ¡†æ¶ä»£ç å®æ–½è§„åˆ’

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

åŸºäºè®¾è®¡æ–‡æ¡£å’Œæ¥å£è®¾è®¡ï¼Œç”Ÿæˆå®Œæ•´çš„æœŸè´§å›æµ‹ç³»ç»ŸåŸºç¡€æ¡†æ¶ä»£ç ï¼ŒåŒ…å«æ•°æ®æ¨¡å—ã€ç­–ç•¥æ¨¡å—ã€å›æµ‹å¼•æ“ã€ç»Ÿè®¡åˆ†æå’ŒæŠ¥å‘Šè¾“å‡ºç­‰äº”å¤§æ ¸å¿ƒæ¨¡å—ã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„è®¾è®¡

### æ¨¡å—ä¾èµ–å…³ç³»å›¾

```mermaid
graph TB
    A[æœŸè´§å›æµ‹ç³»ç»Ÿ] --> B[æ•°æ®æ¨¡å— data/]
    A --> C[ç­–ç•¥æ¨¡å— strategy/]
    A --> D[å›æµ‹å¼•æ“ engine/]
    A --> E[ç»Ÿè®¡åˆ†æ stats/]
    A --> F[æŠ¥å‘Šè¾“å‡º report/]
    
    B --> B1[DataHandler - æ•°æ®å¤„ç†]
    B --> B2[DataCache - æ•°æ®ç¼“å­˜]
    B --> B3[å¤šé¢‘ç‡æ•°æ®æ”¯æŒ]
    
    C --> C1[StrategyBase - ç­–ç•¥åŸºç±»]
    C --> C2[ä¿¡å·ç”Ÿæˆæ¥å£]
    C --> C3[äº¤æ˜“å‚æ•°é…ç½®]
    
    D --> D1[BacktestEngine - å›æµ‹å¼•æ“]
    D --> D2[Portfolio - æŠ•èµ„ç»„åˆ]
    D --> D3[Trade - äº¤æ˜“è®°å½•]
    
    E --> E1[MetricsCalculator - æŒ‡æ ‡è®¡ç®—]
    E --> E2[Visualizer - å›¾è¡¨ç”Ÿæˆ]
    E --> E3[ç»©æ•ˆåˆ†æ]
    
    F --> F1[ReportGenerator - æŠ¥å‘Šç”Ÿæˆ]
    F --> F2[HTMLæ¨¡æ¿]
    F --> F3[Excelå¯¼å‡º]
```

### æ ¸å¿ƒç±»è®¾è®¡

```mermaid
classDiagram
    class StrategyBase {
        <<abstract>>
        -name: str
        -params: dict
        +on_bar(bar_data) : Signal
        +on_start() : void
        +on_finish() : void
        +set_params(params) : void
        +get_params() : dict
    }
    
    class DataHandler {
        -data_cache: dict
        -freq_support: list
        +load_data(csv_path, symbol, freq) : DataFrame
        +get_bar(symbol, datetime, freq) : Bar
        +get_history(symbol, start, end, freq) : DataFrame
        +cache_data(key, data) : void
        +get_cached_data(key) : DataFrame
    }
    
    class BacktestEngine {
        -data_handler: DataHandler
        -strategy: StrategyBase
        -portfolio: Portfolio
        -trade_records: list
        +run() : BacktestResult
        +execute_trades() : void
        +record_state() : void
        +next_bar() : bool
        +process_signals() : void
    }
    
    class Portfolio {
        -cash: float
        -positions: dict
        -equity_curve: list
        +update_position(symbol, quantity) : void
        +calculate_value() : float
        +get_position(symbol) : int
        +record_trade(trade) : void
    }
    
    class MetricsCalculator {
        +calculate_annual_return(equity_curve) : float
        +calculate_max_drawdown(equity_curve) : float
        +calculate_sharpe_ratio(returns) : float
        +calculate_win_rate(trades) : float
        +calculate_profit_loss_ratio(trades) : float
        +calculate_all_metrics(result) : dict
    }
    
    class ReportGenerator {
        -template_engine: Jinja2
        +generate_html(result, output_path) : void
        +export_excel(result, output_path) : void
        +generate_charts(result) : dict
        +create_equity_chart(equity_curve) : Figure
        +create_drawdown_chart(drawdowns) : Figure
    }
    
    BacktestEngine --> DataHandler : uses
    BacktestEngine --> StrategyBase : uses
    BacktestEngine --> Portfolio : contains
    BacktestEngine --> MetricsCalculator : uses
    MetricsCalculator --> ReportGenerator : feeds
```

## ğŸ“ è¯¦ç»†æ–‡ä»¶ç»“æ„

```
pyfback/
â”œâ”€â”€ requirements.txt                 # é¡¹ç›®ä¾èµ–åŒ…
â”œâ”€â”€ setup.py                        # å®‰è£…é…ç½®
â”œâ”€â”€ README.md                       # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ config.py                       # å…¨å±€é…ç½®æ–‡ä»¶
â”œâ”€â”€ data/                           # æ•°æ®æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ data_handler.py            # æ•°æ®å¤„ç†ä¸»ç±»
â”‚   â”œâ”€â”€ data_cache.py              # æ•°æ®ç¼“å­˜æœºåˆ¶
â”‚   â”œâ”€â”€ bar.py                     # Kçº¿æ•°æ®ç»“æ„
â”‚   â””â”€â”€ utils.py                   # æ•°æ®å¤„ç†å·¥å…·å‡½æ•°
â”œâ”€â”€ strategy/                       # ç­–ç•¥æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base.py                    # ç­–ç•¥åŸºç±»
â”‚   â”œâ”€â”€ signals.py                 # äº¤æ˜“ä¿¡å·ç±»
â”‚   â”œâ”€â”€ position.py                # æŒä»“ç®¡ç†
â”‚   â””â”€â”€ examples/                  # ç¤ºä¾‹ç­–ç•¥
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ moving_average.py      # ç§»åŠ¨å¹³å‡ç­–ç•¥
â”‚       â””â”€â”€ dual_thrust.py         # åŒæ¨åŠ›ç­–ç•¥
â”œâ”€â”€ engine/                         # å›æµ‹å¼•æ“
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ backtest_engine.py         # å›æµ‹å¼•æ“ä¸»ç±»
â”‚   â”œâ”€â”€ portfolio.py               # æŠ•èµ„ç»„åˆç®¡ç†
â”‚   â”œâ”€â”€ trade.py                   # äº¤æ˜“è®°å½•ç±»
â”‚   â”œâ”€â”€ execution.py               # äº¤æ˜“æ‰§è¡Œé€»è¾‘
â”‚   â””â”€â”€ events.py                  # äº‹ä»¶é©±åŠ¨ç³»ç»Ÿ
â”œâ”€â”€ stats/                          # ç»Ÿè®¡åˆ†ææ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ metrics.py                 # ç»©æ•ˆæŒ‡æ ‡è®¡ç®—
â”‚   â”œâ”€â”€ visualizer.py              # å›¾è¡¨ç”Ÿæˆ
â”‚   â”œâ”€â”€ risk_analysis.py           # é£é™©åˆ†æ
â”‚   â””â”€â”€ utils.py                   # ç»Ÿè®¡å·¥å…·å‡½æ•°
â”œâ”€â”€ report/                         # æŠ¥å‘Šè¾“å‡ºæ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ generator.py               # æŠ¥å‘Šç”Ÿæˆä¸»ç±»
â”‚   â”œâ”€â”€ templates/                 # HTMLæ¨¡æ¿ç›®å½•
â”‚   â”‚   â”œâ”€â”€ base.html
â”‚   â”‚   â””â”€â”€ backtest_report.html
â”‚   â”œâ”€â”€ excel_exporter.py          # Excelå¯¼å‡ºå™¨
â”‚   â””â”€â”€ chart_factory.py           # å›¾è¡¨å·¥å‚ç±»
â”œâ”€â”€ examples/                       # ä½¿ç”¨ç¤ºä¾‹
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ simple_backtest.py         # ç®€å•å›æµ‹ç¤ºä¾‹
â”‚   â”œâ”€â”€ advanced_strategy.py       # é«˜çº§ç­–ç•¥ç¤ºä¾‹
â”‚   â””â”€â”€ sample_data/               # ç¤ºä¾‹æ•°æ®
â”‚       â””â”€â”€ sample_futures.csv
â”œâ”€â”€ tests/                          # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ test_data.py
â”‚   â”œâ”€â”€ test_strategy.py
â”‚   â”œâ”€â”€ test_engine.py
â”‚   â”œâ”€â”€ test_stats.py
â”‚   â””â”€â”€ test_report.py
â””â”€â”€ docs/                          # å·²å­˜åœ¨çš„æ–‡æ¡£ç›®å½•
    â”œâ”€â”€ design.md
    â””â”€â”€ interface.pdf
```

## ğŸ”§ æŠ€æœ¯æ ˆä¸ä¾èµ–åŒ…

### æ ¸å¿ƒä¾èµ–åŒ…

```txt
# æ•°æ®å¤„ç†ï¼ˆé«˜æ€§èƒ½ï¼‰
pandas>=1.5.0
polars>=0.20.0
numpy>=1.24.0

# æ•°å€¼è®¡ç®—åŠ é€Ÿ
numba>=0.58.0

# å¯è§†åŒ–
matplotlib>=3.6.0
plotly>=5.17.0
seaborn>=0.12.0

# æŠ¥å‘Šç”Ÿæˆ
jinja2>=3.1.0
xlsxwriter>=3.0.0
weasyprint>=59.0

# æ•°æ®æ ¼å¼æ”¯æŒ
pyarrow>=10.0.0
h5py>=3.8.0

# å¼€å‘å·¥å…·
pytest>=7.2.0
black>=23.0.0
isort>=5.12.0
```

### å¯é€‰å¢å¼ºåŒ…

```txt
# æ›´å¤šæ•°æ®æº
tushare>=1.2.0
yfinance>=0.2.0

# æœºå™¨å­¦ä¹ ï¼ˆç”¨äºé«˜çº§ç­–ç•¥ï¼‰
scikit-learn>=1.3.0

# å¹¶è¡Œè®¡ç®—
joblib>=1.3.0
dask>=2023.1.0

# æ›´å¤šå›¾è¡¨ç±»å‹
bokeh>=3.0.0
pyecharts>=2.0.0
```

## ğŸ“‹ æ ¸å¿ƒç±»æ¥å£è®¾è®¡

### 1. æ•°æ®æ¨¡å— (data/)

#### DataHandlerç±»
```python
class DataHandler:
    """æ•°æ®å¤„ç†ä¸»ç±»ï¼Œæ”¯æŒå¤šé¢‘ç‡Kçº¿æ•°æ®åŠ è½½å’Œç¼“å­˜"""
    
    def __init__(self, cache_enabled: bool = True):
        """åˆå§‹åŒ–æ•°æ®å¤„ç†å™¨"""
    
    def load_data(self, csv_path: str, symbol: str, freq: str) -> pl.DataFrame:
        """ä»CSVåŠ è½½å†å²æ•°æ®"""
    
    def get_bar(self, symbol: str, datetime: dt.datetime, freq: str) -> Bar:
        """è·å–æŒ‡å®šæ—¶é—´ç‚¹çš„Kçº¿æ•°æ®"""
    
    def get_history(self, symbol: str, start: dt.datetime, 
                   end: dt.datetime, freq: str) -> pl.DataFrame:
        """è·å–å†å²æ•°æ®åºåˆ—"""
    
    def cache_data(self, key: str, data: pl.DataFrame) -> None:
        """ç¼“å­˜æ•°æ®åˆ°å†…å­˜"""
    
    def get_cached_data(self, key: str) -> Optional[pl.DataFrame]:
        """ä»ç¼“å­˜è·å–æ•°æ®"""
```

#### Baræ•°æ®ç»“æ„
```python
@dataclass
class Bar:
    """Kçº¿æ•°æ®ç»“æ„"""
    symbol: str
    datetime: dt.datetime
    open: float
    high: float
    low: float
    close: float
    volume: int
    open_interest: int
```

### 2. ç­–ç•¥æ¨¡å— (strategy/)

#### StrategyBaseåŸºç±»
```python
class StrategyBase(ABC):
    """ç­–ç•¥åŸºç±»ï¼Œæ‰€æœ‰ç­–ç•¥éƒ½åº”ç»§æ‰¿æ­¤ç±»"""
    
    def __init__(self, name: str, params: Dict[str, Any] = None):
        """åˆå§‹åŒ–ç­–ç•¥"""
    
    @abstractmethod
    def on_bar(self, bar: Bar) -> Optional[Signal]:
        """å¤„ç†æ–°Kçº¿æ•°æ®ï¼Œè¿”å›äº¤æ˜“ä¿¡å·"""
    
    def on_start(self) -> None:
        """å›æµ‹å¼€å§‹å‰çš„åˆå§‹åŒ–"""
    
    def on_finish(self) -> None:
        """å›æµ‹ç»“æŸåçš„æ¸…ç†"""
    
    def set_params(self, params: Dict[str, Any]) -> None:
        """è®¾ç½®ç­–ç•¥å‚æ•°"""
    
    def get_params(self) -> Dict[str, Any]:
        """è·å–ç­–ç•¥å‚æ•°"""
```

#### Signalä¿¡å·ç±»
```python
@dataclass
class Signal:
    """äº¤æ˜“ä¿¡å·æ•°æ®ç»“æ„"""
    symbol: str
    direction: int  # 1:ä¹°å…¥, -1:å–å‡º, 0:å¹³ä»“
    quantity: int
    price_type: str  # 'market', 'limit'
    limit_price: Optional[float] = None
    timestamp: dt.datetime = field(default_factory=dt.datetime.now)
```

### 3. å›æµ‹å¼•æ“ (engine/)

#### BacktestEngineä¸»ç±»
```python
class BacktestEngine:
    """å›æµ‹å¼•æ“ä¸»ç±»ï¼Œåè°ƒæ•´ä¸ªå›æµ‹æµç¨‹"""
    
    def __init__(self, data_handler: DataHandler, strategy: StrategyBase,
                 initial_capital: float = 1000000, 
                 commission: float = 0.0001,
                 slippage: float = 0.0001):
        """åˆå§‹åŒ–å›æµ‹å¼•æ“"""
    
    def run(self, symbol: str, start_date: dt.datetime, 
            end_date: dt.datetime, freq: str = '1min') -> BacktestResult:
        """è¿è¡Œå›æµ‹"""
    
    def execute_trades(self, signals: List[Signal]) -> None:
        """æ‰§è¡Œäº¤æ˜“ä¿¡å·"""
    
    def record_state(self) -> None:
        """è®°å½•å½“å‰å›æµ‹çŠ¶æ€"""
    
    def next_bar(self) -> bool:
        """æ¨è¿›åˆ°ä¸‹ä¸€ä¸ªKçº¿"""
```

#### PortfolioæŠ•èµ„ç»„åˆç±»
```python
class Portfolio:
    """æŠ•èµ„ç»„åˆç®¡ç†ç±»"""
    
    def __init__(self, initial_capital: float):
        """åˆå§‹åŒ–æŠ•èµ„ç»„åˆ"""
    
    def update_position(self, symbol: str, quantity: int, price: float) -> None:
        """æ›´æ–°æŒä»“"""
    
    def calculate_value(self, current_prices: Dict[str, float]) -> float:
        """è®¡ç®—å½“å‰æ€»ä»·å€¼"""
    
    def get_position(self, symbol: str) -> int:
        """è·å–æŒ‡å®šæ ‡çš„æŒä»“"""
    
    def record_trade(self, trade: Trade) -> None:
        """è®°å½•äº¤æ˜“"""
```

### 4. ç»Ÿè®¡åˆ†ææ¨¡å— (stats/)

#### MetricsCalculatorç»©æ•ˆè®¡ç®—ç±»
```python
class MetricsCalculator:
    """ç»©æ•ˆæŒ‡æ ‡è®¡ç®—ç±»"""
    
    @staticmethod
    def calculate_annual_return(equity_curve: List[float], 
                              trading_days: int = 252) -> float:
        """è®¡ç®—å¹´åŒ–æ”¶ç›Šç‡"""
    
    @staticmethod
    def calculate_max_drawdown(equity_curve: List[float]) -> Dict[str, float]:
        """è®¡ç®—æœ€å¤§å›æ’¤"""
    
    @staticmethod
    def calculate_sharpe_ratio(returns: List[float], 
                             risk_free_rate: float = 0.0) -> float:
        """è®¡ç®—å¤æ™®æ¯”ç‡"""
    
    @staticmethod
    def calculate_win_rate(trades: List[Trade]) -> float:
        """è®¡ç®—èƒœç‡"""
    
    @staticmethod
    def calculate_profit_loss_ratio(trades: List[Trade]) -> float:
        """è®¡ç®—ç›ˆäºæ¯”"""
    
    @classmethod
    def calculate_all_metrics(cls, result: BacktestResult) -> Dict[str, float]:
        """è®¡ç®—æ‰€æœ‰ç»©æ•ˆæŒ‡æ ‡"""
```

#### Visualizerå›¾è¡¨ç”Ÿæˆç±»
```python
class Visualizer:
    """å›¾è¡¨ç”Ÿæˆç±»ï¼Œæ”¯æŒmatplotlibå’Œplotly"""
    
    def __init__(self, backend: str = 'plotly'):
        """åˆå§‹åŒ–å¯è§†åŒ–å™¨"""
    
    def create_equity_curve(self, equity_data: List[float], 
                           dates: List[dt.datetime]) -> Figure:
        """åˆ›å»ºæƒç›Šæ›²çº¿å›¾"""
    
    def create_drawdown_chart(self, drawdown_data: List[float],
                             dates: List[dt.datetime]) -> Figure:
        """åˆ›å»ºå›æ’¤æ›²çº¿å›¾"""
    
    def create_position_chart(self, position_data: List[int],
                             dates: List[dt.datetime]) -> Figure:
        """åˆ›å»ºæŒä»“å˜åŒ–å›¾"""
    
    def create_trade_distribution(self, trades: List[Trade]) -> Figure:
        """åˆ›å»ºäº¤æ˜“åˆ†å¸ƒå›¾"""
```

### 5. æŠ¥å‘Šè¾“å‡ºæ¨¡å— (report/)

#### ReportGeneratoræŠ¥å‘Šç”Ÿæˆç±»
```python
class ReportGenerator:
    """æŠ¥å‘Šç”Ÿæˆä¸»ç±»ï¼Œæ”¯æŒHTMLå’ŒExcelè¾“å‡º"""
    
    def __init__(self, template_dir: str = 'report/templates'):
        """åˆå§‹åŒ–æŠ¥å‘Šç”Ÿæˆå™¨"""
    
    def generate_html(self, result: BacktestResult, 
                     output_path: str) -> None:
        """ç”ŸæˆHTMLæŠ¥å‘Š"""
    
    def export_excel(self, result: BacktestResult, 
                    output_path: str) -> None:
        """å¯¼å‡ºExcelæŠ¥å‘Š"""
    
    def generate_charts(self, result: BacktestResult) -> Dict[str, Figure]:
        """ç”Ÿæˆæ‰€æœ‰å›¾è¡¨"""
    
    def _prepare_template_data(self, result: BacktestResult) -> Dict[str, Any]:
        """å‡†å¤‡æ¨¡æ¿æ•°æ®"""
```

## ğŸš€ å®æ–½æ­¥éª¤

### ç¬¬ä¸€é˜¶æ®µï¼šé¡¹ç›®åŸºç¡€è®¾ç½®
1. åˆ›å»ºé¡¹ç›®é…ç½®æ–‡ä»¶ï¼ˆrequirements.txt, setup.py, config.pyï¼‰
2. åˆ›å»ºå„æ¨¡å—çš„__init__.pyæ–‡ä»¶
3. åˆ›å»ºåŸºç¡€çš„æ•°æ®ç»“æ„ç±»ï¼ˆBar, Signal, Tradeç­‰ï¼‰

### ç¬¬äºŒé˜¶æ®µï¼šæ ¸å¿ƒæ¨¡å—å®ç°
1. å®ç°æ•°æ®æ¨¡å—ï¼ˆDataHandler, DataCacheï¼‰
2. å®ç°ç­–ç•¥æ¨¡å—ï¼ˆStrategyBase, ç¤ºä¾‹ç­–ç•¥ï¼‰
3. å®ç°å›æµ‹å¼•æ“ï¼ˆBacktestEngine, Portfolioï¼‰

### ç¬¬ä¸‰é˜¶æ®µï¼šåˆ†æä¸æŠ¥å‘Š
1. å®ç°ç»Ÿè®¡åˆ†ææ¨¡å—ï¼ˆMetricsCalculator, Visualizerï¼‰
2. å®ç°æŠ¥å‘Šç”Ÿæˆæ¨¡å—ï¼ˆReportGenerator, æ¨¡æ¿ï¼‰
3. åˆ›å»ºä½¿ç”¨ç¤ºä¾‹å’Œæµ‹è¯•ç”¨ä¾‹

### ç¬¬å››é˜¶æ®µï¼šå®Œå–„ä¸ä¼˜åŒ–
1. æ·»åŠ å•å…ƒæµ‹è¯•
2. æ€§èƒ½ä¼˜åŒ–ï¼ˆnumbaåŠ é€Ÿï¼‰
3. æ–‡æ¡£å®Œå–„

## ğŸ¯ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### ä½¿ç”¨Polarsæå‡æ•°æ®å¤„ç†æ€§èƒ½
- æ›¿ä»£pandasè¿›è¡Œå¤§è§„æ¨¡æ•°æ®æ“ä½œ
- åˆ©ç”¨lazy evaluationå»¶è¿Ÿè®¡ç®—
- å¹¶è¡Œå¤„ç†å¤šä¸ªåˆçº¦æ•°æ®

### ä½¿ç”¨NumbaåŠ é€Ÿå…³é”®è®¡ç®—
- JITç¼–è¯‘å›æµ‹å¾ªç¯æ ¸å¿ƒé€»è¾‘
- åŠ é€ŸæŒ‡æ ‡è®¡ç®—å‡½æ•°
- ä¼˜åŒ–å‘é‡åŒ–æ“ä½œ

### ä½¿ç”¨Plotlyå¢å¼ºå¯è§†åŒ–
- äº¤äº’å¼å›¾è¡¨æå‡ç”¨æˆ·ä½“éªŒ
- æ”¯æŒå¤§è§„æ¨¡æ•°æ®ç‚¹æ¸²æŸ“
- ä¾¿äºWebç•Œé¢é›†æˆ

## ğŸ“Š ç¤ºä¾‹ä½¿ç”¨ä»£ç 

```python
# ç®€å•å›æµ‹ç¤ºä¾‹
from data import DataHandler
from strategy.examples import MovingAverageStrategy
from engine import BacktestEngine
from stats import MetricsCalculator, Visualizer
from report import ReportGenerator

# åˆå§‹åŒ–ç»„ä»¶
data_handler = DataHandler()
strategy = MovingAverageStrategy(fast_period=5, slow_period=20)
engine = BacktestEngine(data_handler, strategy, initial_capital=1000000)

# è¿è¡Œå›æµ‹
result = engine.run(
    symbol='IH2312', 
    start_date=datetime(2023, 1, 1),
    end_date=datetime(2023, 12, 31),
    freq='1min'
)

# è®¡ç®—ç»©æ•ˆæŒ‡æ ‡
metrics = MetricsCalculator.calculate_all_metrics(result)
print(f"å¹´åŒ–æ”¶ç›Šç‡: {metrics['annual_return']:.2%}")
print(f"æœ€å¤§å›æ’¤: {metrics['max_drawdown']:.2%}")
print(f"å¤æ™®æ¯”ç‡: {metrics['sharpe_ratio']:.2f}")

# ç”ŸæˆæŠ¥å‘Š
visualizer = Visualizer(backend='plotly')
report_generator = ReportGenerator()

# ç”ŸæˆHTMLæŠ¥å‘Š
report_generator.generate_html(result, 'backtest_report.html')

# å¯¼å‡ºExcelæ˜ç»†
report_generator.export_excel(result, 'backtest_details.xlsx')
```

æ­¤åŸºç¡€æ¡†æ¶è®¾è®¡éµå¾ªæ¨¡å—åŒ–ã€å¯æ‰©å±•çš„åŸåˆ™ï¼Œé›†æˆäº†é«˜æ€§èƒ½è®¡ç®—åº“ï¼Œèƒ½å¤Ÿæ”¯æŒä»ç®€å•çš„ç§»åŠ¨å¹³å‡ç­–ç•¥åˆ°å¤æ‚çš„å¤šå› å­ç­–ç•¥çš„å„ç§å›æµ‹éœ€æ±‚ã€‚